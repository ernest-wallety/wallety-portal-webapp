<ng-template #personalDetailsTemplate>
   <div class="modal-header">
      <h4 class="modal-title float-start">
         <i class="bx bx-user"></i> Customer Details
      </h4>
      <button type="button" class="btn-close float-end" aria-label="Close" (click)="modalDialog.dismiss()"></button>
   </div>

   <form #form="ngForm" autocomplete="off">
      <div class="modal-body rs-modal-content">

         <!-- Tabs and Content -->
         <ul class="nav nav-tabs mt-1" id="left-tabes" role="tablist">
            <li class="nav-item" role="presentation">
               <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#personal-details" role="tab"
                  aria-controls="personal-details" aria-selected="true" (click)="switchTab('customer-verification')">
                  Customer Verification
               </button>
            </li>

            <li class="nav-item" role="presentation">
               <button class="nav-link" data-bs-toggle="tab" data-bs-target="#verification-history" role="tab"
                  aria-controls="verification-history" aria-selected="false"
                  (click)="switchTab('verification-history')">
                  Verification History
               </button>
            </li>
         </ul>

         <div class="tab-content tabs p-0 mt-2">
            <!-- Customer Verification Tab -->
            <div class="tab-pane show active" id="personal-details" role="tabpanel">
               <div class="view-content">
                  <div class="row">
                     <div class="col-6">
                        <div class="row">
                           <div class="mb-3 col">
                              <label for="name" class="col-form-label">Name</label>
                              <input [disabled]="true" name="name" class="form-control form-control-sm"
                                 [(ngModel)]="model.Name" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="surname" class="col-form-label">Surname</label>
                              <input [disabled]="true" name="surname" class="form-control form-control-sm"
                                 [(ngModel)]="model.Surname" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="passport" class="col-form-label">National ID No. / Passport No.</label>
                              <input [disabled]="true"
                                 *ngIf="model.PassportNumber !== null && model.PassportNumber !== ''" name="passport"
                                 class="form-control form-control-sm" [(ngModel)]="model.PassportNumber" />
                              <input [disabled]="true" *ngIf="model.IdNumber !== null && model.IdNumber !== ''"
                                 name="idNumber" class="form-control form-control-sm" [(ngModel)]="model.IdNumber" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="country" class="col-form-label">Country</label>
                              <input [disabled]="true" name="country" class="form-control form-control-sm"
                                 [(ngModel)]="model.Country" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="phoneNumber" class="col-form-label">WhatsApp Number</label>
                              <input [disabled]="true" name="phoneNumber" class="form-control form-control-sm"
                                 [(ngModel)]="model.PhoneNumber" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="accountCreationDate" class="col-form-label">Registration Date</label>
                              <input [disabled]="true" name="accountCreationDate" class="form-control form-control-sm"
                                 [(ngModel)]="model.AccountCreationDate" />
                           </div>
                        </div>

                        <div class="row">
                           <div class="mb-3 col">
                              <label for="status" class="col-form-label">Update Status</label>
                              <app-select-single-lookup #status name="status" id="status" from="body" [Items]="statuses"
                                 [BindValue]="'Name'" [(ngModel)]="RegistrationStatus"
                                 (OnChangeEmitter)="updateStatus($event, 'Status')">
                              </app-select-single-lookup>
                           </div>
                        </div>

                        <div class="row" *ngIf="RegistrationStatus !== undefined && RegistrationStatus === 'Rejected'">
                           <div class="mb-3 col">
                              <label for="reason" class="col-form-label">Rejection Reason</label>
                              <app-select-single-lookup #reason name="reason" id="reason" from="body" [Items]="reasons"
                                 [BindValue]="'Name'" [(ngModel)]="RejectionReason"
                                 (OnChangeEmitter)="updateReason($event, 'Reasons')">
                              </app-select-single-lookup>
                           </div>
                        </div>
                     </div>
                     <div class="col-6 d-flex align-items-center">
                        <!-- Image Section -->
                        <div class="image-section text-center w-100 h-100 d-flex flex-column justify-content-center">
                           <div class="scrollable-image">
                              <img [src]="imageUrl" alt="Identity Image" class="img-fluid rounded" />
                           </div>
                           <p class="mt-2">Customer ID</p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

            <!-- Verification History Tab -->
            <div class="tab-pane show" id="verification-history" role="tabpanel">
               <div class="view-content">
                  <!-- Show message when no records are available -->
                  <div *ngIf="!model.History || model.History.length === 0" class="no-records">
                     <p>No history records found.</p>
                  </div>

                  <!-- Display history records -->
                  <div *ngIf="model.History && model.History.length > 0">
                     <div *ngFor="let record of model.History" class="history-card">
                        <div class="history-header">
                           <span class="status" [class.rejected]="record.Status === 'Rejected'">
                              Status: {{ record.Status }}
                           </span>
                           <span class="date">Updated on: {{ record.Date }}</span>
                        </div>
                        <div class="history-content">
                           <p><strong>Rejection Reason:</strong></p>
                           <p>{{ record.RejectionReason }}</p>
                        </div>
                        <div class="history-footer">
                           <p><strong>Updated By:</strong> {{ record.UpdatedBy }}</p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>

      </div>

      <div class="modal-footer bg-light-gray">
         <div class="me-auto"></div>

         <button *ngIf="IsLoading" type="button" class="btn btn-outline-success me-2" [disabled]="true">
            <i class="fa fa-spinner fa-spin"></i> Busy ...
         </button>

         <button *ngIf="!IsLoading" type="button" class="btn btn-primary btn-sm" (click)="update()"
            [disabled]="(RegistrationStatus !== undefined || RegistrationStatus === '') &&  activeTab !== 'customer-verification'">
            <i class='bx bxs-edit'></i> Update
         </button>
      </div>
   </form>
</ng-template>